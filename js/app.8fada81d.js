(function(){"use strict";var t={1316:function(t,e,a){var s=a(3751),n=a(641);const i={id:"app",class:"container-fluid"},r={id:"search"},l={class:"form-row"},u={class:"form-group col-md-4"},o={class:"form-group col-md-4"},c={class:"col-md-4"},d={class:"options-column"},p={class:"checkbox-inline",for:"only-failures-checkbox"},f={class:"checkbox-inline",for:"group-by-lang"},m={class:"options-column"},h={class:"radio-inline",for:"suite-readonly"},g={class:"radio-inline",for:"suite-readwrite"};function k(t,e,a,k,x,_){const v=(0,n.g2)("ci-grid");return(0,n.uX)(),(0,n.CE)("div",i,[e[10]||(e[10]=(0,n.Lk)("h1",null,"Kaitai Struct CI",-1)),(0,n.Lk)("form",r,[(0,n.Lk)("div",l,[(0,n.Lk)("div",u,[(0,n.bo)((0,n.Lk)("input",{name:"filterTest",class:"form-control","onUpdate:modelValue":e[0]||(e[0]=e=>t.filterTest=e),placeholder:"Search test..."},null,512),[[s.Jo,t.filterTest]])]),(0,n.Lk)("div",o,[(0,n.bo)((0,n.Lk)("input",{name:"filterTarget",class:"form-control","onUpdate:modelValue":e[1]||(e[1]=e=>t.filterTarget=e),placeholder:"Search target..."},null,512),[[s.Jo,t.filterTarget]])]),(0,n.Lk)("div",c,[(0,n.Lk)("div",d,[(0,n.Lk)("label",p,[(0,n.bo)((0,n.Lk)("input",{type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=e=>t.skipPassed=e),id:"only-failures-checkbox"},null,512),[[s.lH,t.skipPassed]]),e[6]||(e[6]=(0,n.eW)(" Only failures ",-1))]),(0,n.Lk)("label",f,[(0,n.bo)((0,n.Lk)("input",{type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=e=>t.groupByLang=e),id:"group-by-lang"},null,512),[[s.lH,t.groupByLang]]),e[7]||(e[7]=(0,n.eW)(" Group columns by language ",-1))])]),(0,n.Lk)("div",m,[(0,n.Lk)("label",h,[(0,n.bo)((0,n.Lk)("input",{type:"radio",name:"suite",id:"suite-readonly",value:"readonly","onUpdate:modelValue":e[4]||(e[4]=e=>t.suite=e)},null,512),[[s.XL,t.suite]]),e[8]||(e[8]=(0,n.eW)(" Parsing ",-1))]),(0,n.Lk)("label",g,[(0,n.bo)((0,n.Lk)("input",{type:"radio",name:"suite",id:"suite-readwrite",value:"readwrite","onUpdate:modelValue":e[5]||(e[5]=e=>t.suite=e)},null,512),[[s.XL,t.suite]]),e[9]||(e[9]=(0,n.eW)(" Serialization ",-1))])])])])]),(0,n.bF)(v,{data:_.groupedGridData,columns:_.groupedGridColumns,meta:_.groupedGridMeta,"filter-key":t.filterTest,"filter-columns-key":t.filterTarget,"skip-passed":t.skipPassed,"group-by-lang":t.groupByLang},null,8,["data","columns","meta","filter-key","filter-columns-key","skip-passed","group-by-lang"])])}a(4114),a(8111),a(116),a(7588),a(1701),a(7642),a(8004),a(3853),a(5876),a(2475),a(5024),a(1698);var x=a(33);const _={class:"table table-fixed"},v={class:"row-sticky-top"},y=["href"],C=["href"];function b(t,e,a,s,i,r){const l=(0,n.g2)("ci-cell");return(0,n.uX)(),(0,n.CE)("table",_,[(0,n.Lk)("thead",null,[(0,n.Lk)("tr",v,[e[0]||(e[0]=(0,n.Lk)("th",null,"Test \\ Target",-1)),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.filteredColumns,(t,e)=>((0,n.uX)(),(0,n.CE)("th",{key:e},(0,x.v_)(t.replace("/"," ")),1))),128))]),(0,n.Lk)("tr",null,[e[1]||(e[1]=(0,n.Lk)("th",null,"Last update",-1)),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.filteredColumns,(t,e)=>((0,n.uX)(),(0,n.CE)("th",{key:e},[(0,n.eW)((0,x.v_)(r.humanTime(a.meta[t].timestamp))+" ",1),a.meta[t].ci?((0,n.uX)(),(0,n.CE)("a",{key:0,class:"ext-link",href:a.meta[t].ci.url},"Job",8,y)):(0,n.Q3)("",!0),(0,n.Lk)("a",{class:"ext-link",href:a.meta[t].artifactsUrl},"Artifacts",8,C)]))),128))]),(0,n.Lk)("tr",null,[e[2]||(e[2]=(0,n.Lk)("th",null,"Rating",-1)),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.filteredColumns,(t,e)=>((0,n.uX)(),(0,n.CE)("th",{key:e},(0,x.v_)(r.passRating[t])+"% ",1))),128))])]),(0,n.Lk)("tbody",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.filteredData,t=>((0,n.uX)(),(0,n.CE)("tr",{key:t.name},[(0,n.Lk)("td",null,(0,x.v_)(t.name),1),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.filteredColumns,e=>((0,n.uX)(),(0,n.Wv)(l,{key:t.name+"/"+e,data:t.value[e]||{}},null,8,["data"]))),128))]))),128))]),(0,n.Lk)("tfoot",null,[(0,n.Lk)("tr",null,[e[3]||(e[3]=(0,n.Lk)("th",null,"KST adoption",-1)),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(r.filteredColumns,t=>((0,n.uX)(),(0,n.CE)("th",{key:t},(0,x.v_)(r.kstRating[t])+"% ",1))),128))])])])}a(1148),a(2489);const L={key:0},w={key:0,class:"failure-info"};function j(t,e,a,i,r,l){return(0,n.uX)(),(0,n.CE)("td",{class:(0,x.C4)(l.cssClassObject),style:(0,x.Tr)(l.mixedBgGradientStyle),onClick:e[1]||(e[1]=e=>t.details=!t.details)},[(0,n.eW)((0,x.v_)(a.data.status||"unknown")+" ",1),t.details&&l.hasDetails?((0,n.uX)(),(0,n.CE)("div",{key:0,class:"add-info",onClick:e[0]||(e[0]=(0,s.D$)(()=>{},["stop"]))},[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(l.results,(t,s)=>((0,n.uX)(),(0,n.CE)("div",{class:"result",key:s},[(0,n.Lk)("h4",{class:(0,x.C4)([l.getCssClassByStatus(t.status,a.data.is_kst)])},[t.variant_names?((0,n.uX)(),(0,n.CE)("span",L,(0,x.v_)(t.variant_names.join(", "))+": ",1)):(0,n.Q3)("",!0),(0,n.Lk)("strong",null,(0,x.v_)(t.status),1)],2),t.failure?((0,n.uX)(),(0,n.CE)("div",w,[t.failure.message?((0,n.uX)(),(0,n.CE)(n.FK,{key:0},[e[2]||(e[2]=(0,n.eW)(" Message: ",-1)),(0,n.Lk)("pre",null,(0,x.v_)(t.failure.message),1)],64)):(0,n.Q3)("",!0),t.failure.trace?((0,n.uX)(),(0,n.CE)(n.FK,{key:1},[e[3]||(e[3]=(0,n.eW)(" Stack trace: ",-1)),(0,n.Lk)("pre",null,(0,x.v_)(t.failure.trace),1)],64)):(0,n.Q3)("",!0)])):(0,n.Q3)("",!0)]))),128))])):(0,n.Q3)("",!0)],6)}const O=Object.freeze({passed:"#aea","passed-kst":"#7d7",skipped:"#cef",failed:"#edd",leak:"#ecc","format-build-failed":"#fd9","spec-build-failed":"#fd9","no-spec":"#ebb"});var E={name:"CiCell",props:{data:Object},data:function(){return{details:!1}},computed:{results:function(){return this.data.agg_results||[this.data]},hasDetails:function(){return!!this.data.failure||"mixed"===this.data.status},mixedBgGradientStyle:function(){if("mixed"!==this.data.status)return{};const t=10,e=Array.from(new Set(this.data.agg_results.map(t=>t.status)),(e,a)=>{const s=this.getStatusColorByCssClass(this.getCssClassByStatus(e,this.data.is_kst));return[s+" "+(a*t).toFixed(0)+"px",s+" "+((a+1)*t).toFixed(0)+"px"]}).flat();return{backgroundImage:"repeating-linear-gradient(135deg, "+e.join(", ")+")"}},cssClassObject:function(){const t={"has-details":this.hasDetails},e=this.getCssClassByStatus(this.data.status,this.data.is_kst);return e&&(t[e]=!0),t}},methods:{getCssClassByStatus:function(t,e){switch(t){case"passed":return e?"passed-kst":t;case"failed":case"leak":case"skipped":return t;case"format_build_failed":return"format-build-failed";case"spec_build_failed":return"spec-build-failed";case"unknown":case void 0:return"no-spec"}},getStatusColorByCssClass:function(t){return Object.prototype.hasOwnProperty.call(O,t)?O[t]:"transparent"}}},X=a(6262);const D=(0,X.A)(E,[["render",j],["__scopeId","data-v-2cd93e02"]]);var T=D,S={name:"CiGrid",components:{CiCell:T},props:{data:Array,columns:Array,meta:Object,filterKey:String,filterColumnsKey:String,skipPassed:Boolean},computed:{filteredData:function(){var t=this.filterKey&&this.filterKey.toLowerCase(),e=this.data;if(t&&(e=e.filter(e=>this.strContainsCaseInsensitive(e.name,t))),this.skipPassed){var a=this.filteredColumns;e=e.filter(function(t){return!a.every(function(e){return t.value[e]&&"passed"===t.value[e].status})})}return e=e.slice().sort(function(t,e){return t=t.name,e=e.name,t===e?0:t>e?1:-1}),e},filteredColumns:function(){if(this.filterColumnsKey&&""!==this.filterColumnsKey){var t=this.filterColumnsKey.toLowerCase();return this.columns.filter(e=>e.toLowerCase().indexOf(t)>-1)}return this.columns},passRating:function(){var t={};for(var e in this.meta)t[e]=Math.round(this.meta[e].passed/this.data.length*100*10)/10;return t},kstRating:function(){var t={};for(var e in this.meta)t[e]=Math.round(this.meta[e].kst/this.data.length*100*10)/10;return t}},methods:{strContainsCaseInsensitive:(t,e)=>t.toLowerCase().indexOf(e)>-1,humanTime:function(t){var e=(new Date-t)/1e3;return e<60?"just now":e<3600?Math.round(e/60)+"m ago":e<86400?Math.round(e/3600)+"h ago":Math.round(e/86400)+"d ago"}}};const K=(0,X.A)(S,[["render",b],["__scopeId","data-v-6895e66d"]]);var P=K;const B=[["cpp_stl_98","clang3.4-linux-x86_64"],["cpp_stl_98","clang18-linux-x86_64"],["cpp_stl_98","gcc4.8-linux-x86_64"],["cpp_stl_98","gcc13-linux-x86_64"],["cpp_stl_98","clang16-macos-x86_64"],["cpp_stl_98","msvc141-windows-x64"],["cpp_stl_11","clang3.4-linux-x86_64"],["cpp_stl_11","clang18-linux-x86_64"],["cpp_stl_11","gcc4.8-linux-x86_64"],["cpp_stl_11","gcc13-linux-x86_64"],["cpp_stl_11","clang16-macos-x86_64"],["cpp_stl_11","msvc141-windows-x64"],["csharp","net48-windows-x64"],["csharp","net6.0-linux-x86_64"],["csharp","net9.0-linux-x86_64"],["graphviz","12-linux-x86_64"],["go","1.25-linux-x86_64"],["java","zulu7-linux-x86_64"],["java","temurin8-linux-x86_64"],["java","temurin11-linux-x86_64"],["java","temurin17-linux-x86_64"],["java","temurin21-linux-x86_64"],["javascript","nodejs10-linux-x86_64"],["javascript","nodejs12-linux-x86_64"],["javascript","nodejs18-linux-x86_64"],["javascript","nodejs24-linux-x86_64"],["lua","5.3-linux-x86_64"],["lua","5.4-linux-x86_64"],["nim","1.6.20-linux-x86_64"],["nim","2.2.4-linux-x86_64"],["perl","5.30-linux-x86_64"],["perl","5.42-linux-x86_64"],["php","7.1-linux-x86_64"],["php","8.4-linux-x86_64"],["python","2.7-linux-x86_64"],["python","3.4-linux-x86_64"],["python","3.13-linux-x86_64"],["construct","python3.6-linux-x86_64"],["construct","python3.13-linux-x86_64"],["ruby","1.9-linux-x86_64"],["ruby","2.3-linux-x86_64"],["ruby","3.4-linux-x86_64"],["rust","1.89-linux-x86_64"]];B.forEach(t=>Object.freeze(t)),Object.freeze(B);var F=B;const I=new Set(["java","python"]);Object.freeze(I);var G={name:"app",components:{CiGrid:P},data:function(){return{filterTest:"",filterTarget:"",suiteData:{readonly:{testData:{},gridColumns:[],gridMeta:{}},readwrite:{testData:{},gridColumns:[],gridMeta:{}}},skipPassed:!1,groupByLang:!0,suite:"readonly"}},created:function(){const t=this.getPairCompareFunc(F);F.forEach(e=>{this.addOneJson(e[0],e[1],t,"readonly"),I.has(e[0])&&this.addOneJson(e[0],e[1],t,"readwrite")})},computed:{groupedGridColumns:function(){const t=this.suiteData[this.suite].gridColumns;return this.groupByLang?Array.from(new Set(t.map(t=>t.split("/")[0]))):t},groupedGridData:function(){const t=this.suiteData[this.suite];if(!this.groupByLang)return Object.entries(t.testData).map(([t,e])=>({name:t,value:e}));const e=[];for(const a in t.testData){const s=t.testData[a],n={};e.push({name:a,value:n}),t.gridColumns.forEach(t=>{let e=s[t];e||(e={}),e.status||(e.status="unknown");const a=t.split("/");a.length<2&&console.error('target key "'+t+'" is invalid (does not have the format "{lang}/{variant}")');const i=a[0],r=a[1];Object.prototype.hasOwnProperty.call(n,i)||(n[i]={status:e.status,is_kst:!0,failure:!1,agg_results:[]});const l=n[i];e.status!==l.status&&(l.status="mixed"),"unknown"===e.status||e.is_kst||(l.is_kst=!1),e.failure&&(l.failure=!0);let u=l.agg_results.find(t=>t.status===e.status&&(!t.failure&&!e.failure||!(!t.failure||!e.failure)&&(t.failure.message===e.failure.message&&t.failure.trace===e.failure.trace)));u||(u={status:e.status,variant_names:[]},e.failure&&(u.failure=e.failure),l.agg_results.push(u)),u.variant_names.push(r)})}return e},groupedGridMeta:function(){const t=this.suiteData[this.suite].gridMeta;if(!this.groupByLang)return t;const e={};return Object.entries(t).forEach(([t,a])=>{const s=t.split("/")[0];if(!Object.prototype.hasOwnProperty.call(e,s))return void(e[s]={lang:a.lang,timestamp:a.timestamp,ci:{},kst:0,passed:0});const n=e[s];a.timestamp>n.timestamp&&(n.timestamp=a.timestamp)}),this.groupedGridData.forEach(t=>{Object.entries(t.value).forEach(([t,a])=>{Object.prototype.hasOwnProperty.call(e,t)&&("passed"===a.status&&e[t].passed++,a.is_kst&&e[t].kst++)})}),e}},methods:{addOneJson:function(t,e,a,s){var n=t+"/"+e;t+="readwrite"===s?"-write":"";const i=this.suiteData[s];console.log("Querying data for",n),fetch("https://raw.githubusercontent.com/kaitai-io/ci_artifacts/"+n+"/test_out/"+t+"/ci.json").then(t=>{if(!t.ok)throw new Error("HTTP error, status code: "+t.status);return t.json()}).then(e=>{var s=e.$meta;delete e.$meta,console.log("Got answer for "+n+", meta:",s);var r=0,l=0;for(const t in e){Object.prototype.hasOwnProperty.call(i.testData,t)||(i.testData[t]={});var u=i.testData[t];u[n]=e[t],"passed"===u[n].status&&r++,u[n].is_kst&&l++}i.gridColumns.push(n),i.gridColumns.sort(a),s.passed=r,s.kst=l,s.timestamp=new Date(s.timestamp),s.artifactsUrl="https://github.com/kaitai-io/ci_artifacts/tree/"+n+"/test_out/"+t,i.gridMeta[n]=s}).catch(t=>{console.warn("Cannot fetch data for "+n+". "+t)})},getPairCompareFunc:function(t){const e=e=>t.findIndex(t=>t.join("/")===e);return(t,a)=>e(t)-e(a)}}};const M=(0,X.A)(G,[["render",k]]);var W=M;const A=(0,s.Ef)(W);A.mount("#app")}},e={};function a(s){var n=e[s];if(void 0!==n)return n.exports;var i=e[s]={exports:{}};return t[s].call(i.exports,i,i.exports,a),i.exports}a.m=t,function(){var t=[];a.O=function(e,s,n,i){if(!s){var r=1/0;for(c=0;c<t.length;c++){s=t[c][0],n=t[c][1],i=t[c][2];for(var l=!0,u=0;u<s.length;u++)(!1&i||r>=i)&&Object.keys(a.O).every(function(t){return a.O[t](s[u])})?s.splice(u--,1):(l=!1,i<r&&(r=i));if(l){t.splice(c--,1);var o=n();void 0!==o&&(e=o)}}return e}i=i||0;for(var c=t.length;c>0&&t[c-1][2]>i;c--)t[c]=t[c-1];t[c]=[s,n,i]}}(),function(){a.d=function(t,e){for(var s in e)a.o(e,s)&&!a.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={524:0};a.O.j=function(e){return 0===t[e]};var e=function(e,s){var n,i,r=s[0],l=s[1],u=s[2],o=0;if(r.some(function(e){return 0!==t[e]})){for(n in l)a.o(l,n)&&(a.m[n]=l[n]);if(u)var c=u(a)}for(e&&e(s);o<r.length;o++)i=r[o],a.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return a.O(c)},s=self["webpackChunkkaitai_ci_ui"]=self["webpackChunkkaitai_ci_ui"]||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))}();var s=a.O(void 0,[504],function(){return a(1316)});s=a.O(s)})();
//# sourceMappingURL=app.8fada81d.js.map