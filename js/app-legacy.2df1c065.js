(function(){"use strict";var t={7142:function(t,e,r){r(6992),r(8674),r(9601),r(7727);var a=r(9963),n=r(6252),s={id:"app",class:"container-fluid"},i=(0,n._)("h1",null,"Kaitai Struct CI",-1),o={id:"search"},u={class:"form-row"},l={class:"form-group col-md-4"},c={class:"form-group col-md-4"},f={class:"col-md-4 options-column"},d={class:"checkbox-inline",for:"only-failures-checkbox"},p={class:"checkbox-inline",for:"group-by-lang"};function g(t,e,r,g,h,m){var _=(0,n.up)("ci-grid");return(0,n.wg)(),(0,n.iD)("div",s,[i,(0,n._)("form",o,[(0,n._)("div",u,[(0,n._)("div",l,[(0,n.wy)((0,n._)("input",{name:"filterTest",class:"form-control","onUpdate:modelValue":e[0]||(e[0]=function(e){return t.filterTest=e}),placeholder:"Search test..."},null,512),[[a.nr,t.filterTest]])]),(0,n._)("div",c,[(0,n.wy)((0,n._)("input",{name:"filterTarget",class:"form-control","onUpdate:modelValue":e[1]||(e[1]=function(e){return t.filterTarget=e}),placeholder:"Search target..."},null,512),[[a.nr,t.filterTarget]])]),(0,n._)("div",f,[(0,n._)("label",d,[(0,n.wy)((0,n._)("input",{type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=function(e){return t.skipPassed=e}),id:"only-failures-checkbox"},null,512),[[a.e8,t.skipPassed]]),(0,n.Uk)(" Only failures ")]),(0,n._)("label",p,[(0,n.wy)((0,n._)("input",{type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=function(e){return t.groupByLang=e}),id:"group-by-lang"},null,512),[[a.e8,t.groupByLang]]),(0,n.Uk)(" Group columns by language ")])])])]),(0,n.Wm)(_,{data:m.groupedGridData,columns:m.groupedGridColumns,meta:m.groupedGridMeta,"filter-key":t.filterTest,"filter-columns-key":t.filterTarget,"skip-passed":t.skipPassed,"group-by-lang":t.groupByLang},null,8,["data","columns","meta","filter-key","filter-columns-key","skip-passed","group-by-lang"])])}var h=r(8818),m=(r(1539),r(3371),r(1038),r(8783),r(189),r(3948),r(1249),r(2707),r(7941),r(4747),r(9826),r(7658),r(9720),r(1703),r(8309),r(4553),r(9600),r(4916),r(5306),r(3577)),_=function(t){return(0,n.dD)("data-v-47106377"),t=t(),(0,n.Cn)(),t},v={class:"table table-fixed"},y={class:"row-sticky-top"},k=_((function(){return(0,n._)("th",null,"Test \\ Target",-1)})),w=["onClick"],C=_((function(){return(0,n._)("th",null,"Last update",-1)})),b=["href"],D=["href"],j=_((function(){return(0,n._)("th",null,"Rating",-1)})),O=_((function(){return(0,n._)("th",null,"KST adoption",-1)}));function x(t,e,r,a,s,i){var o=(0,n.up)("ci-cell");return(0,n.wg)(),(0,n.iD)("table",v,[(0,n._)("thead",null,[(0,n._)("tr",y,[k,((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(i.filteredColumns,(function(e,r){return(0,n.wg)(),(0,n.iD)("th",{key:r,onClick:function(t){return i.sortBy(e)},class:(0,m.C_)({active:t.sortKey===e})},[(0,n.Uk)((0,m.zw)(e.replace("/"," "))+" ",1),(0,n._)("span",{class:(0,m.C_)(["arrow",t.sortOrders[e]>0?"asc":"dsc"])},null,2)],10,w)})),128))]),(0,n._)("tr",null,[C,((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(i.filteredColumns,(function(t,e){return(0,n.wg)(),(0,n.iD)("th",{key:e},[(0,n.Uk)((0,m.zw)(i.humanTime(r.meta[t].timestamp))+" ",1),r.meta[t].ci?((0,n.wg)(),(0,n.iD)("a",{key:0,class:"ext-link",href:r.meta[t].ci.url},"Job",8,b)):(0,n.kq)("",!0),(0,n._)("a",{class:"ext-link",href:r.meta[t].artifactsUrl},"Artifacts",8,D)])})),128))]),(0,n._)("tr",null,[j,((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(i.filteredColumns,(function(t,e){return(0,n.wg)(),(0,n.iD)("th",{key:e},(0,m.zw)(i.passRating[t])+"% ",1)})),128))])]),(0,n._)("tbody",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(i.filteredData,(function(t){return(0,n.wg)(),(0,n.iD)("tr",{key:t.name},[(0,n._)("td",null,(0,m.zw)(t.name),1),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(i.filteredColumns,(function(e){return(0,n.wg)(),(0,n.j4)(o,{key:t.name+"/"+e,data:t[e]||{}},null,8,["data"])})),128))])})),128))]),(0,n._)("tfoot",null,[(0,n._)("tr",null,[O,((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(i.filteredColumns,(function(t){return(0,n.wg)(),(0,n.iD)("th",{key:t},(0,m.zw)(i.kstRating[t])+"% ",1)})),128))])])])}r(7327),r(7042);var K={key:0},T={key:0,class:"failure-info"};function B(t,e,r,s,i,o){return(0,n.wg)(),(0,n.iD)("td",{class:(0,m.C_)(o.cssClassObject),style:(0,m.j5)(o.mixedBgGradientStyle),onClick:e[1]||(e[1]=function(e){return t.details=!t.details})},[(0,n.Uk)((0,m.zw)(r.data.status||"unknown")+" ",1),t.details&&o.hasDetails?((0,n.wg)(),(0,n.iD)("div",{key:0,class:"add-info",onClick:e[0]||(e[0]=(0,a.iM)((function(){}),["stop"]))},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(o.results,(function(t,e){return(0,n.wg)(),(0,n.iD)("div",{class:"result",key:e},[(0,n._)("h4",{class:(0,m.C_)([o.getCssClassByStatus(t.status,r.data.is_kst)])},[t.variant_names?((0,n.wg)(),(0,n.iD)("span",K,(0,m.zw)(t.variant_names.join(", "))+": ",1)):(0,n.kq)("",!0),(0,n._)("strong",null,(0,m.zw)(t.status),1)],2),t.failure?((0,n.wg)(),(0,n.iD)("div",T,[t.failure.message?((0,n.wg)(),(0,n.iD)(n.HY,{key:0},[(0,n.Uk)(" Message: "),(0,n._)("pre",null,(0,m.zw)(t.failure.message),1)],64)):(0,n.kq)("",!0),t.failure.trace?((0,n.wg)(),(0,n.iD)(n.HY,{key:1},[(0,n.Uk)(" Stack trace: "),(0,n._)("pre",null,(0,m.zw)(t.failure.trace),1)],64)):(0,n.kq)("",!0)])):(0,n.kq)("",!0)])})),128))])):(0,n.kq)("",!0)],6)}r(4944),r(3792),r(6977);var S=Object.freeze({passed:"#dff0d8","passed-kst":"#82dc75",skipped:"#b9cfbb",failed:"#f2dede",leak:"#f2cece","no-spec":"#f2bebe"}),P={name:"CiCell",props:{data:Object},data:function(){return{details:!1}},computed:{results:function(){return this.data.agg_results||[this.data]},hasDetails:function(){return!!this.data.failure||"mixed"===this.data.status},mixedBgGradientStyle:function(){var t=this;if("mixed"!==this.data.status)return{};var e=10,r=Array.from(this.data.agg_status_set,(function(r,a){var n=t.getStatusColorByCssClass(t.getCssClassByStatus(r,t.data.is_kst));return[n+" "+(a*e).toFixed(0)+"px",n+" "+((a+1)*e).toFixed(0)+"px"]})).flat();return{backgroundImage:"repeating-linear-gradient(135deg, "+r.join(", ")+")"}},cssClassObject:function(){var t={"has-details":this.hasDetails},e=this.getCssClassByStatus(this.data.status,this.data.is_kst);return e&&(t[e]=!0),t}},methods:{getCssClassByStatus:function(t,e){return"passed"===t&&e?"passed-kst":["passed","failed","leak"].indexOf(t)>-1?t:void 0===t?"no-spec":void 0},getStatusColorByCssClass:function(t){return Object.prototype.hasOwnProperty.call(S,t)?S[t]:"transparent"}}},z=r(3744);const G=(0,z.Z)(P,[["render",B],["__scopeId","data-v-b5c690f0"]]);var M=G,U={name:"CiGrid",components:{CiCell:M},props:{data:Array,columns:Array,meta:Object,filterKey:String,filterColumnsKey:String,skipPassed:Boolean},data:function(){var t={};return this.columns.forEach((function(e){t[e]=1})),{sortKey:"name",sortOrders:t}},computed:{filteredData:function(){var t=this,e=this.sortKey,r=this.filterKey&&this.filterKey.toLowerCase(),a=this.sortOrders[e]||1,n=this.data;if(r&&(n=n.filter((function(e){return t.strContainsCaseInsensitive(String(e.name),r)}))),this.skipPassed){var s=this.filteredColumns;n=n.filter((function(t){return!s.every((function(e){return"name"===e||t[e]&&"passed"===t[e].status}))}))}return e&&(n=n.slice().sort((function(t,r){return t=t[e],r=r[e],(t===r?0:t>r?1:-1)*a}))),n},filteredColumns:function(){if(this.filterColumnsKey&&""!==this.filterColumnsKey){var t=this.filterColumnsKey.toLowerCase();return this.columns.filter((function(e){return e.toLowerCase().indexOf(t)>-1}))}return this.columns},passRating:function(){var t={};for(var e in this.meta)t[e]=Math.round(this.meta[e].passed/this.data.length*100*10)/10;return t},kstRating:function(){var t={};for(var e in this.meta)t[e]=Math.round(this.meta[e].kst/this.data.length*100*10)/10;return t}},methods:{sortBy:function(t){this.sortKey=t,this.sortOrders[t]=-1*this.sortOrders[t]},strContainsCaseInsensitive:function(t,e){return t.toLowerCase().indexOf(e)>-1},humanTime:function(t){var e=(new Date-t)/1e3;return e<60?"just now":e<3600?Math.round(e/60)+"m ago":e<86400?Math.round(e/3600)+"h ago":Math.round(e/86400)+"d ago"}}};const L=(0,z.Z)(U,[["render",x],["__scopeId","data-v-47106377"]]);var H=L,E=[["cpp_stl_98","gcc4.8_linux"],["cpp_stl_98","clang3.5_linux"],["cpp_stl_98","clang7.3_osx"],["cpp_stl_98","msvc141_windows_x64"],["cpp_stl_11","gcc4.8_linux"],["cpp_stl_11","clang3.5_linux"],["cpp_stl_11","clang7.3_osx"],["cpp_stl_11","msvc141_windows_x64"],["csharp","mono5.18.0"],["csharp","net45_windows"],["csharp","netcore2.2.103_linux"],["csharp","netcore3.0.100_linux"],["graphviz","2.36"],["go","1.19"],["java","zulu7"],["java","temurin8"],["java","temurin11"],["java","temurin17"],["javascript","nodejs4"],["javascript","nodejs8"],["javascript","nodejs10"],["javascript","nodejs12"],["javascript","nodejs16"],["lua","5.3"],["nim","1.6.0"],["perl","5.24"],["perl","5.38"],["php","7.1"],["php","8.0"],["python","2.7"],["python","3.4"],["python","3.11"],["construct","python2.7"],["construct","python3.4"],["construct","python3.10"],["ruby","1.9"],["ruby","2.3"],["ruby","3.2"]];E.forEach((function(t){return Object.freeze(t)})),Object.freeze(E);var Y={name:"app",components:{CiGrid:H},data:function(){return{testData:{},filterTest:"",filterTarget:"",gridColumns:[],gridData:[],gridMeta:{},skipPassed:!1,groupByLang:!0}},created:function(){var t=this,e=this.getPairCompareFunc(E);E.forEach((function(r){return t.addOneJson(r[0],r[1],e)}))},computed:{groupedGridColumns:function(){return this.groupByLang?Array.from(new Set(this.gridColumns.map((function(t){return t.split("/")[0]})))):this.gridColumns},groupedGridData:function(){if(!this.groupByLang)return this.gridData;var t=this.getPairCompareFunc(E);return this.gridData.map((function(e){var r={},a=Object.keys(e).sort(t);return a.forEach((function(t){var a=e[t];if("name"!==t){var n=t.split("/",2);n.length<2&&console.error('target key "'+t+'" is invalid (does not have the format "{lang}/{variant}")');var s=n[0],i=n[1];Object.prototype.hasOwnProperty.call(r,s)||(r[s]={status:a.status,is_kst:a.is_kst,failure:!1,agg_status_set:new Set,agg_results:[]});var o=r[s];"mixed"!==o.status&&a.status!==o.status&&(o.status="mixed"),a.is_kst!==o.is_kst&&(o.is_kst=!1),a.failure&&!o.failure&&(o.failure=!0);var u=o.agg_results.find((function(t){return t.status===a.status&&(!t.failure&&!a.failure||!(!t.failure||!a.failure)&&(t.failure.message===a.failure.message&&t.failure.trace===a.failure.trace))}));if(u)u.variant_names.push(i);else{var l={status:a.status,variant_names:[i]};a.failure&&(l.failure=a.failure),o.agg_results.push(l)}o.agg_status_set.add(a.status)}else r[t]=a})),r}))},groupedGridMeta:function(){if(!this.groupByLang)return this.gridMeta;var t={};return Object.entries(this.gridMeta).forEach((function(e){var r=(0,h.Z)(e,2),a=r[0],n=r[1],s=a.split("/")[0];if(Object.prototype.hasOwnProperty.call(t,s)){var i=t[s];n.timestamp>i.timestamp&&(i.timestamp=n.timestamp)}else t[s]={lang:n.lang,timestamp:n.timestamp,ci:{},kst:0,passed:0}})),this.groupedGridData.forEach((function(e){Object.entries(e).forEach((function(e){var r=(0,h.Z)(e,2),a=r[0],n=r[1];"name"!==a&&Object.prototype.hasOwnProperty.call(t,a)&&("passed"===n.status&&t[a].passed++,n.is_kst&&t[a].kst++)}))})),t}},methods:{addOneJson:function(t,e,r){var a=this,n=t+"/"+e;console.log("Querying data for",n),fetch("https://raw.githubusercontent.com/kaitai-io/ci_artifacts/"+n+"/test_out/"+t+"/ci.json").then((function(t){if(!t.ok)throw new Error("HTTP error, status code: "+t.status);return t.json()})).then((function(e){var s=e.$meta;delete e.$meta,console.log("Got answer for "+n+", meta:",s);var i=0,o=0;for(var u in e){Object.prototype.hasOwnProperty.call(a.testData,u)||(a.testData[u]={name:u});var l=a.testData[u];delete e[u]["name"],l[n]=e[u],"passed"===l[n].status&&i++,l[n].is_kst&&o++}for(var c in a.gridColumns.push(n),a.gridColumns=a.gridColumns.sort(r),a.gridData=[],a.testData)a.gridData.push(a.testData[c]);s.passed=i,s.kst=o,s.timestamp=new Date(s.timestamp),s.artifactsUrl="https://github.com/kaitai-io/ci_artifacts/tree/"+n+"/test_out/"+t,a.gridMeta[n]=s})).catch((function(t){console.warn("Cannot fetch data for "+n+". "+t)}))},getPairCompareFunc:function(t){return function(e,r){var a=function(e){return t.findIndex((function(t){return t.join("/")===e}))};return a(e)-a(r)}}}};const I=(0,z.Z)(Y,[["render",g]]);var q=I,F=(0,a.ri)(q);F.mount("#app")}},e={};function r(a){var n=e[a];if(void 0!==n)return n.exports;var s=e[a]={exports:{}};return t[a].call(s.exports,s,s.exports,r),s.exports}r.m=t,function(){var t=[];r.O=function(e,a,n,s){if(!a){var i=1/0;for(c=0;c<t.length;c++){a=t[c][0],n=t[c][1],s=t[c][2];for(var o=!0,u=0;u<a.length;u++)(!1&s||i>=s)&&Object.keys(r.O).every((function(t){return r.O[t](a[u])}))?a.splice(u--,1):(o=!1,s<i&&(i=s));if(o){t.splice(c--,1);var l=n();void 0!==l&&(e=l)}}return e}s=s||0;for(var c=t.length;c>0&&t[c-1][2]>s;c--)t[c]=t[c-1];t[c]=[a,n,s]}}(),function(){r.d=function(t,e){for(var a in e)r.o(e,a)&&!r.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};r.O.j=function(e){return 0===t[e]};var e=function(e,a){var n,s,i=a[0],o=a[1],u=a[2],l=0;if(i.some((function(e){return 0!==t[e]}))){for(n in o)r.o(o,n)&&(r.m[n]=o[n]);if(u)var c=u(r)}for(e&&e(a);l<i.length;l++)s=i[l],r.o(t,s)&&t[s]&&t[s][0](),t[s]=0;return r.O(c)},a=self["webpackChunkkaitai_ci_ui"]=self["webpackChunkkaitai_ci_ui"]||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))}();var a=r.O(void 0,[998],(function(){return r(7142)}));a=r.O(a)})();
//# sourceMappingURL=app-legacy.2df1c065.js.map