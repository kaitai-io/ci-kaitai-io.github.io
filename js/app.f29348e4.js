(function(){"use strict";var t={5466:function(t,e,a){var s=a(9963),n=a(6252);const i={id:"app",class:"container-fluid"},r=(0,n._)("h1",null,"Kaitai Struct CI",-1),l={id:"search"},o={class:"form-row"},u={class:"form-group col-md-4"},c={class:"form-group col-md-4"},d={class:"col-md-4 options-column"},p={class:"checkbox-inline",for:"only-failures-checkbox"},f={class:"checkbox-inline",for:"group-by-lang"};function h(t,e,a,h,g,m){const _=(0,n.up)("ci-grid");return(0,n.wg)(),(0,n.iD)("div",i,[r,(0,n._)("form",l,[(0,n._)("div",o,[(0,n._)("div",u,[(0,n.wy)((0,n._)("input",{name:"filterTest",class:"form-control","onUpdate:modelValue":e[0]||(e[0]=e=>t.filterTest=e),placeholder:"Search test..."},null,512),[[s.nr,t.filterTest]])]),(0,n._)("div",c,[(0,n.wy)((0,n._)("input",{name:"filterTarget",class:"form-control","onUpdate:modelValue":e[1]||(e[1]=e=>t.filterTarget=e),placeholder:"Search target..."},null,512),[[s.nr,t.filterTarget]])]),(0,n._)("div",d,[(0,n._)("label",p,[(0,n.wy)((0,n._)("input",{type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=e=>t.skipPassed=e),id:"only-failures-checkbox"},null,512),[[s.e8,t.skipPassed]]),(0,n.Uk)(" Only failures ")]),(0,n._)("label",f,[(0,n.wy)((0,n._)("input",{type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=e=>t.groupByLang=e),id:"group-by-lang"},null,512),[[s.e8,t.groupByLang]]),(0,n.Uk)(" Group columns by language ")])])])]),(0,n.Wm)(_,{data:m.groupedGridData,columns:m.groupedGridColumns,meta:m.groupedGridMeta,"filter-key":t.filterTest,"filter-columns-key":t.filterTarget,"skip-passed":t.skipPassed,"group-by-lang":t.groupByLang},null,8,["data","columns","meta","filter-key","filter-columns-key","skip-passed","group-by-lang"])])}a(7658);var g=a(3577);const m=t=>((0,n.dD)("data-v-6895e66d"),t=t(),(0,n.Cn)(),t),_={class:"table table-fixed"},x={class:"row-sticky-top"},y=m((()=>(0,n._)("th",null,"Test \\ Target",-1))),k=m((()=>(0,n._)("th",null,"Last update",-1))),v=["href"],w=["href"],C=m((()=>(0,n._)("th",null,"Rating",-1))),b=m((()=>(0,n._)("th",null,"KST adoption",-1)));function j(t,e,a,s,i,r){const l=(0,n.up)("ci-cell");return(0,n.wg)(),(0,n.iD)("table",_,[(0,n._)("thead",null,[(0,n._)("tr",x,[y,((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(r.filteredColumns,((t,e)=>((0,n.wg)(),(0,n.iD)("th",{key:e},(0,g.zw)(t.replace("/"," ")),1)))),128))]),(0,n._)("tr",null,[k,((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(r.filteredColumns,((t,e)=>((0,n.wg)(),(0,n.iD)("th",{key:e},[(0,n.Uk)((0,g.zw)(r.humanTime(a.meta[t].timestamp))+" ",1),a.meta[t].ci?((0,n.wg)(),(0,n.iD)("a",{key:0,class:"ext-link",href:a.meta[t].ci.url},"Job",8,v)):(0,n.kq)("",!0),(0,n._)("a",{class:"ext-link",href:a.meta[t].artifactsUrl},"Artifacts",8,w)])))),128))]),(0,n._)("tr",null,[C,((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(r.filteredColumns,((t,e)=>((0,n.wg)(),(0,n.iD)("th",{key:e},(0,g.zw)(r.passRating[t])+"% ",1)))),128))])]),(0,n._)("tbody",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(r.filteredData,(t=>((0,n.wg)(),(0,n.iD)("tr",{key:t.name},[(0,n._)("td",null,(0,g.zw)(t.name),1),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(r.filteredColumns,(e=>((0,n.wg)(),(0,n.j4)(l,{key:t.name+"/"+e,data:t.value[e]||{}},null,8,["data"])))),128))])))),128))]),(0,n._)("tfoot",null,[(0,n._)("tr",null,[b,((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(r.filteredColumns,(t=>((0,n.wg)(),(0,n.iD)("th",{key:t},(0,g.zw)(r.kstRating[t])+"% ",1)))),128))])])])}const D={key:0},O={key:0,class:"failure-info"};function T(t,e,a,i,r,l){return(0,n.wg)(),(0,n.iD)("td",{class:(0,g.C_)(l.cssClassObject),style:(0,g.j5)(l.mixedBgGradientStyle),onClick:e[1]||(e[1]=e=>t.details=!t.details)},[(0,n.Uk)((0,g.zw)(a.data.status||"unknown")+" ",1),t.details&&l.hasDetails?((0,n.wg)(),(0,n.iD)("div",{key:0,class:"add-info",onClick:e[0]||(e[0]=(0,s.iM)((()=>{}),["stop"]))},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(l.results,((t,e)=>((0,n.wg)(),(0,n.iD)("div",{class:"result",key:e},[(0,n._)("h4",{class:(0,g.C_)([l.getCssClassByStatus(t.status,a.data.is_kst)])},[t.variant_names?((0,n.wg)(),(0,n.iD)("span",D,(0,g.zw)(t.variant_names.join(", "))+": ",1)):(0,n.kq)("",!0),(0,n._)("strong",null,(0,g.zw)(t.status),1)],2),t.failure?((0,n.wg)(),(0,n.iD)("div",O,[t.failure.message?((0,n.wg)(),(0,n.iD)(n.HY,{key:0},[(0,n.Uk)(" Message: "),(0,n._)("pre",null,(0,g.zw)(t.failure.message),1)],64)):(0,n.kq)("",!0),t.failure.trace?((0,n.wg)(),(0,n.iD)(n.HY,{key:1},[(0,n.Uk)(" Stack trace: "),(0,n._)("pre",null,(0,g.zw)(t.failure.trace),1)],64)):(0,n.kq)("",!0)])):(0,n.kq)("",!0)])))),128))])):(0,n.kq)("",!0)],6)}const S=Object.freeze({passed:"#aea","passed-kst":"#7d7",skipped:"#cef",failed:"#edd",leak:"#ecc","format-build-failed":"#fd9","spec-build-failed":"#fd9","no-spec":"#ebb"});var B={name:"CiCell",props:{data:Object},data:function(){return{details:!1}},computed:{results:function(){return this.data.agg_results||[this.data]},hasDetails:function(){return!!this.data.failure||"mixed"===this.data.status},mixedBgGradientStyle:function(){if("mixed"!==this.data.status)return{};const t=10,e=Array.from(new Set(this.data.agg_results.map((t=>t.status))),((e,a)=>{const s=this.getStatusColorByCssClass(this.getCssClassByStatus(e,this.data.is_kst));return[s+" "+(a*t).toFixed(0)+"px",s+" "+((a+1)*t).toFixed(0)+"px"]})).flat();return{backgroundImage:"repeating-linear-gradient(135deg, "+e.join(", ")+")"}},cssClassObject:function(){const t={"has-details":this.hasDetails},e=this.getCssClassByStatus(this.data.status,this.data.is_kst);return e&&(t[e]=!0),t}},methods:{getCssClassByStatus:function(t,e){switch(t){case"passed":return e?"passed-kst":t;case"failed":case"leak":case"skipped":return t;case"format_build_failed":return"format-build-failed";case"spec_build_failed":return"spec-build-failed";case"unknown":case void 0:return"no-spec"}},getStatusColorByCssClass:function(t){return Object.prototype.hasOwnProperty.call(S,t)?S[t]:"transparent"}}},K=a(3744);const P=(0,K.Z)(B,[["render",T],["__scopeId","data-v-2cd93e02"]]);var z=P,G={name:"CiGrid",components:{CiCell:z},props:{data:Array,columns:Array,meta:Object,filterKey:String,filterColumnsKey:String,skipPassed:Boolean},computed:{filteredData:function(){var t=this.filterKey&&this.filterKey.toLowerCase(),e=this.data;if(t&&(e=e.filter((e=>this.strContainsCaseInsensitive(e.name,t)))),this.skipPassed){var a=this.filteredColumns;e=e.filter((function(t){return!a.every((function(e){return t.value[e]&&"passed"===t.value[e].status}))}))}return e=e.slice().sort((function(t,e){return t=t.name,e=e.name,t===e?0:t>e?1:-1})),e},filteredColumns:function(){if(this.filterColumnsKey&&""!==this.filterColumnsKey){var t=this.filterColumnsKey.toLowerCase();return this.columns.filter((e=>e.toLowerCase().indexOf(t)>-1))}return this.columns},passRating:function(){var t={};for(var e in this.meta)t[e]=Math.round(this.meta[e].passed/this.data.length*100*10)/10;return t},kstRating:function(){var t={};for(var e in this.meta)t[e]=Math.round(this.meta[e].kst/this.data.length*100*10)/10;return t}},methods:{strContainsCaseInsensitive:(t,e)=>t.toLowerCase().indexOf(e)>-1,humanTime:function(t){var e=(new Date-t)/1e3;return e<60?"just now":e<3600?Math.round(e/60)+"m ago":e<86400?Math.round(e/3600)+"h ago":Math.round(e/86400)+"d ago"}}};const M=(0,K.Z)(G,[["render",j],["__scopeId","data-v-6895e66d"]]);var L=M;const U=[["cpp_stl_98","clang3.4-linux-x86_64"],["cpp_stl_98","clang11-linux-x86_64"],["cpp_stl_98","gcc4.8-linux-x86_64"],["cpp_stl_98","gcc11-linux-x86_64"],["cpp_stl_98","clang14-macos-x86_64"],["cpp_stl_98","msvc141-windows-x64"],["cpp_stl_11","clang3.4-linux-x86_64"],["cpp_stl_11","clang11-linux-x86_64"],["cpp_stl_11","gcc4.8-linux-x86_64"],["cpp_stl_11","clang14-macos-x86_64"],["cpp_stl_11","msvc141-windows-x64"],["csharp","net48-windows-x64"],["csharp","netcore2.2.103-linux-x86_64"],["csharp","netcore3.0.100-linux-x86_64"],["csharp","netcore6.0-linux-x86_64"],["graphviz","8-linux-x86_64"],["go","1.19-linux-x86_64"],["java","zulu7-linux-x86_64"],["java","temurin8-linux-x86_64"],["java","temurin11-linux-x86_64"],["java","temurin17-linux-x86_64"],["javascript","nodejs4-linux-x86_64"],["javascript","nodejs8-linux-x86_64"],["javascript","nodejs10-linux-x86_64"],["javascript","nodejs12-linux-x86_64"],["javascript","nodejs18-linux-x86_64"],["lua","5.3-linux-x86_64"],["nim","1.6.0-linux-x86_64"],["perl","5.24-linux-x86_64"],["perl","5.38-linux-x86_64"],["php","7.1-linux-x86_64"],["php","8.2-linux-x86_64"],["python","2.7-linux-x86_64"],["python","3.4-linux-x86_64"],["python","3.11-linux-x86_64"],["construct","python2.7-linux-x86_64"],["construct","python3.4-linux-x86_64"],["construct","python3.11-linux-x86_64"],["ruby","1.9-linux-x86_64"],["ruby","2.3-linux-x86_64"],["ruby","3.2-linux-x86_64"]];U.forEach((t=>Object.freeze(t))),Object.freeze(U);var H={name:"app",components:{CiGrid:L},data:function(){return{testData:{},filterTest:"",filterTarget:"",gridColumns:[],gridMeta:{},skipPassed:!1,groupByLang:!0}},created:function(){const t=this.getPairCompareFunc(U);U.forEach((e=>this.addOneJson(e[0],e[1],t)))},computed:{groupedGridColumns:function(){return this.groupByLang?Array.from(new Set(this.gridColumns.map((t=>t.split("/")[0])))):this.gridColumns},groupedGridData:function(){if(!this.groupByLang)return Object.entries(this.testData).map((([t,e])=>({name:t,value:e})));const t=[];for(const e in this.testData){const a=this.testData[e],s={};t.push({name:e,value:s}),this.gridColumns.forEach((t=>{let e=a[t];e||(e={}),e.status||(e.status="unknown");const n=t.split("/");n.length<2&&console.error('target key "'+t+'" is invalid (does not have the format "{lang}/{variant}")');const i=n[0],r=n[1];Object.prototype.hasOwnProperty.call(s,i)||(s[i]={status:e.status,is_kst:!0,failure:!1,agg_results:[]});const l=s[i];e.status!==l.status&&(l.status="mixed"),"unknown"===e.status||e.is_kst||(l.is_kst=!1),e.failure&&(l.failure=!0);let o=l.agg_results.find((t=>t.status===e.status&&(!t.failure&&!e.failure||!(!t.failure||!e.failure)&&(t.failure.message===e.failure.message&&t.failure.trace===e.failure.trace))));o||(o={status:e.status,variant_names:[]},e.failure&&(o.failure=e.failure),l.agg_results.push(o)),o.variant_names.push(r)}))}return t},groupedGridMeta:function(){if(!this.groupByLang)return this.gridMeta;const t={};return Object.entries(this.gridMeta).forEach((([e,a])=>{const s=e.split("/")[0];if(!Object.prototype.hasOwnProperty.call(t,s))return void(t[s]={lang:a.lang,timestamp:a.timestamp,ci:{},kst:0,passed:0});const n=t[s];a.timestamp>n.timestamp&&(n.timestamp=a.timestamp)})),this.groupedGridData.forEach((e=>{Object.entries(e.value).forEach((([e,a])=>{Object.prototype.hasOwnProperty.call(t,e)&&("passed"===a.status&&t[e].passed++,a.is_kst&&t[e].kst++)}))})),t}},methods:{addOneJson:function(t,e,a){var s=t+"/"+e;console.log("Querying data for",s),fetch("https://raw.githubusercontent.com/kaitai-io/ci_artifacts/"+s+"/test_out/"+t+"/ci.json").then((t=>{if(!t.ok)throw new Error("HTTP error, status code: "+t.status);return t.json()})).then((e=>{var n=e.$meta;delete e.$meta,console.log("Got answer for "+s+", meta:",n);var i=0,r=0;for(const t in e){Object.prototype.hasOwnProperty.call(this.testData,t)||(this.testData[t]={});var l=this.testData[t];delete e[t]["name"],l[s]=e[t],"passed"===l[s].status&&i++,l[s].is_kst&&r++}this.gridColumns.push(s),this.gridColumns=this.gridColumns.sort(a),n.passed=i,n.kst=r,n.timestamp=new Date(n.timestamp),n.artifactsUrl="https://github.com/kaitai-io/ci_artifacts/tree/"+s+"/test_out/"+t,this.gridMeta[s]=n})).catch((t=>{console.warn("Cannot fetch data for "+s+". "+t)}))},getPairCompareFunc:function(t){const e=e=>t.findIndex((t=>t.join("/")===e));return(t,a)=>e(t)-e(a)}}};const Y=(0,K.Z)(H,[["render",h]]);var E=Y;const I=(0,s.ri)(E);I.mount("#app")}},e={};function a(s){var n=e[s];if(void 0!==n)return n.exports;var i=e[s]={exports:{}};return t[s].call(i.exports,i,i.exports,a),i.exports}a.m=t,function(){var t=[];a.O=function(e,s,n,i){if(!s){var r=1/0;for(c=0;c<t.length;c++){s=t[c][0],n=t[c][1],i=t[c][2];for(var l=!0,o=0;o<s.length;o++)(!1&i||r>=i)&&Object.keys(a.O).every((function(t){return a.O[t](s[o])}))?s.splice(o--,1):(l=!1,i<r&&(r=i));if(l){t.splice(c--,1);var u=n();void 0!==u&&(e=u)}}return e}i=i||0;for(var c=t.length;c>0&&t[c-1][2]>i;c--)t[c]=t[c-1];t[c]=[s,n,i]}}(),function(){a.d=function(t,e){for(var s in e)a.o(e,s)&&!a.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};a.O.j=function(e){return 0===t[e]};var e=function(e,s){var n,i,r=s[0],l=s[1],o=s[2],u=0;if(r.some((function(e){return 0!==t[e]}))){for(n in l)a.o(l,n)&&(a.m[n]=l[n]);if(o)var c=o(a)}for(e&&e(s);u<r.length;u++)i=r[u],a.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return a.O(c)},s=self["webpackChunkkaitai_ci_ui"]=self["webpackChunkkaitai_ci_ui"]||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))}();var s=a.O(void 0,[998],(function(){return a(5466)}));s=a.O(s)})();
//# sourceMappingURL=app.f29348e4.js.map